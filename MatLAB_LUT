clc;
clear all;
close all;

bits=[1 0 1 0]; %Input Message bits
n = 8000;
message_bit_binary = [repmat(bits(1),n,1);repmat(bits(2),n,1);repmat(bits(3),n,1);repmat(bits(4),n,1)];
message_bit = (2 * message_bit_binary) - 1;
figure(1);
subplot(3,1,1);
stairs(message_bit);
title('Digital Input');
xlabel('Bits -->');
ylabel('1 or 0 -->');
fc = 120e3;
t = 0 : 1/(9.6e6) : 400/fc; 
zer = [repmat(0,15,1);];

carrier_signal = sin(2 * pi * fc * t);
subplot(3,1,2);
plot(carrier_signal);
xlabel('Time -->');
ylabel('Amplitude -->');
title('Carrier Signal');
xlim([0 32000]);
subplot(3,1,3);
y1 = carrier_signal(1 : 32000);
bpsk_signal = y1' .* message_bit;
plot(bpsk_signal);
xlabel('Time -->');
ylabel('Amplitude -->');
title('BPSK Output');

% At reciever
% COSTAS generates sine and cos

rec_sin = y1;
rec_cos_ext = cos(2 * pi * fc * t);
rec_cos = rec_cos_ext(1: 32000);

%mul_sin = horzcat(zeros(1,15),bpsk_signal(1:31985)') .* rec_sin;
%mul_cos = horzcat(zeros(1,15),bpsk_signal(1:31985)') .* rec_cos;
%mul_sin = bpsk_signal' .* rec_sin;
%mul_cos = bpsk_signal' .* rec_cos;
mul_sin = horzcat(bpsk_signal(16:32000)',bpsk_signal(1:15)') .* rec_sin;
mul_cos = horzcat(bpsk_signal(16:32000)',bpsk_signal(1:15)') .* rec_cos;

figure(2);
subplot(2,1,1);
plot(mul_sin);
title('sin');
subplot(2,1,2);
plot(mul_cos);
title('cos');

fil_coeff = [-3.06407413954917e-05,3.88666338364547e-05,3.45228699961383e-05,3.79870921639086e-05,4.57605486090573e-05,5.63790099858873e-05,6.92480468414559e-05,8.41700731484088e-05,0.000101095234700965,0.000120050638969978,0.000141068119920134,0.000164190798870247,0.000189435777747655,0.000216815569173164,0.000246307895985598,0.000277880500320432,0.000311462882576880,0.000346971664009829,0.000384283083381531,0.000423258806136680,0.000463719034780796,0.000505468523745652,0.000548270863869313,0.000591875042383926,0.000635991131344177,0.000680317423289792,0.000724518358064113,0.000768249623924540,0.000811145637200738,0.000852814364232319,0.000892911702156326,0.000930943713027837,0.000966663459321278,0.000999514394982450,0.00102918182529550,0.00105532300675473,0.00107749862160338,0.00109537261573755,0.00110866973896642,0.00111711513033243,0.00112042535275341,0.00111837692208613,0.00111079990073462,0.00109758548297334,0.00107865737960569,0.00105399472317289,0.00102362111172862,0.000987627807278237,0.000946156291953633,0.000899414828534797,0.000847660094390404,0.000791212604532820,0.000730438786517532,0.000665764745959372,0.000597657556686056,0.000526636776745298,0.000453254420033164,0.000378106467101825,0.000301807309594783,0.000225011266096251,0.000148361331255145,7.25552863234774e-05,-1.77387035401682e-06,-7.39182103943538e-05,-0.000143257253575443,-0.000209150548302986,-0.000270981700616504,-0.000328199841864864,-0.000380281044628104,-0.000426734623200886,-0.000467153031300441,-0.000501186865911540,-0.000528541965033473,-0.000548994973782714,-0.000562413452127669,-0.000568737117468277,-0.000567978444830152,-0.000560225433041453,-0.000545655914358072,-0.000524527610294248,-0.000497174641876562,-0.000463997148650752,-0.000425465389171147,-0.000382112798806305,-0.000334533963561470,-0.000283372376850920,-0.000229314563943658,-0.000173080290125052,-0.000115413121048971,-5.70774392494650e-05,1.16500237913292e-06,5.85391127115271e-05,0.000114307683659333,0.000167726039497334,0.000218111821978267,0.000264805237174775,0.000307199408700968,0.000344759297967737,0.000377000467849776,0.000403516582632650,0.000423988535571798,0.000438169019539266,0.000445898443719604,0.000447114307872116,0.000441840344286906,0.000430184642433961,0.000412350764406740,0.000388630560960300,0.000359394593844842,0.000325087574582561,0.000286231032232203,0.000243411000569501,0.000197267999771596,0.000148485864543144,9.77898104171208e-05,4.59334289112132e-05,-6.31261672583422e-06,-5.81758125771192e-05,-0.000108890442396419,-0.000157704524634687,-0.000203896740909895,-0.000246776447822431,-0.000285714339023659,-0.000320125765214131,-0.000349507361005986,-0.000373420058267764,-0.000391507253898978,-0.000403506415521024,-0.000409234633055663,-0.000408612322643847,-0.000401653978679479,-0.000388465629753992,-0.000369250910570586,-0.000344308646898737,-0.000314017556362906,-0.000278843926435940,-0.000239330058947103,-0.000196083949397595,-0.000149769408212541,-0.000101104966701900,-5.08443207718203e-05,2.33044238200366e-07,5.13334666926273e-05,0.000101656093384248,0.000150413015883812,0.000196837925734623,0.000240199400121135,0.000279806420137797,0.000315028019306567,0.000345296447864744,0.000370124886760675,0.000389099899664676,0.000401907978976980,0.000408320646671165,0.000408221368910749,0.000401585034665167,0.000388492953784088,0.000369128831967067,0.000343772740961769,0.000312805631485511,0.000276698241071409,0.000236000302507780,0.000191342287359710,0.000143417522404322,9.29740861539524e-05,4.08071879384541e-05,-1.22567824713025e-05,-6.53757219002342e-05,-0.000117698384940092,-0.000168381669842934,-0.000216605447226913,-0.000261583319809913,-0.000302573512350337,-0.000338895631005722,-0.000369940199115785,-0.000395176541125184,-0.000414163075031353,-0.000426556578525578,-0.000432118431764753,-0.000430714449251630,-0.000422324253930742,-0.000407036320260477,-0.000385056437165981,-0.000356691139961457,-0.000322358479850360,-0.000282570706896469,-0.000237935163580332,-0.000189140941250390,-0.000136945536225613,-8.21711356844803e-05,-2.56863738189903e-05,3.16076676763005e-05,8.87871790004457e-05,0.000144926733375070,0.000199109077318620,0.000250439255459646,0.000298063298540243,0.000341181660185946,0.000379058794945381,0.000411040615525717,0.000436562203030405,0.000455157563038635,0.000466468920583249,0.000470256193958826,0.000466396735324246,0.000454891355690830,0.000435865324112567,0.000409567205052743,0.000376364188681789,0.000336738965340443,0.000291284693569558,0.000240691459938112,0.000185740784118701,0.000127289069560860,6.62612361291507e-05,3.62869610472787e-06,-5.96021674344357e-05,-0.000122404362517083,-0.000183751696215942,-0.000242628668821802,-0.000298055235060350,-0.000349096499575980,-0.000394879495464152,-0.000434610347563412,-0.000467587422705800,-0.000493210210850345,-0.000510995500741959,-0.000520580514996786,-0.000521733999059619,-0.000514360646519420,-0.000498503145667948,-0.000474340515033717,-0.000442191622764166,-0.000402507436051924,-0.000355866462104797,-0.000302965778407537,-0.000244612441900505,-0.000181707184597773,-0.000115236134011642,-4.62518403256546e-05,2.41398750544400e-05,9.48037818840560e-05,0.000164584552407943,0.000232334473193572,0.000296924222671615,0.000357268916070740,0.000412339002055470,0.000461182329170659,0.000502940614454311,0.000536861209206057,0.000562312936116689,0.000578796844499311,0.000585954971277827,0.000583580499205085,0.000571617978441591,0.000550168646306322,0.000519491633260520,0.000479998165518619,0.000432247478952771,0.000376940730527705,0.000314908666946289,0.000247101135080755,0.000174572395793624,9.84633346944140e-05,1.99851971848758e-05,-5.95985951963207e-05,-0.000138994368860783,-0.000216899617628328,-0.000292021249014567,-0.000363099900534966,-0.000428928377796532,-0.000488374904730534,-0.000540398042291797,-0.000584071218684803,-0.000618591774039035,-0.000643300612057584,-0.000657690996181785,-0.000661421659859617,-0.000654322623905585,-0.000636398144283884,-0.000607831487855772,-0.000568982037161993,-0.000520380095045351,-0.000462723166378992,-0.000396863093405334,-0.000323796403229365,-0.000244647791762693,-0.000160652499197408,-7.31389752584774e-05,1.64914732557254e-05,0.000106790491610650,0.000196281941637141,0.000283487733525262,0.000366951518438847,0.000445263436354313,0.000517082361126813,0.000581160810857630,0.000636363812383791,0.000681690067285356,0.000716290775598435,0.000739483609729422,0.000750765940471367,0.000749824827120827,0.000736546227770061,0.000711015744165886,0.000673521893884384,0.000624552755946382,0.000564789139052792,0.000495097837792508,0.000416516313096390,0.000330241556358892,0.000237607145899030,0.000140066661502563,3.91704658178099e-05,-6.34592481415192e-05,-0.000166154999731449,-0.000267228761895830,-0.000365002635441001,-0.000457832675348493,-0.000544139677818541,-0.000622433723658288,-0.000691339754590524,-0.000749621821375045,-0.000796206625256528,-0.000830199247672145,-0.000850902659603595,-0.000857830219721054,-0.000850716961112408,-0.000829524432645101,-0.000794446827345814,-0.000745906399160176,-0.000684553562157931,-0.000611254817961073,-0.000527084279118563,-0.000433304186184608,-0.000331351618758526,-0.000222812388452414,-0.000109398538226471,7.07848917941029e-06,0.000124736733272724,0.000241653148591869,0.000355895887374739,0.000465555063218378,0.000568774103622529,0.000663782584260908,0.000748923812117662,0.000822684532977004,0.000883722586346968,0.000930888812917662,0.000963249201928251,0.000980102542871292,0.000980994188353147,0.000965727676574643,0.000934369781638677,0.000887251773533178,0.000824968980398018,0.000748372500296638,0.000658558286059258,0.000556852312673343,0.000444792895645779,0.000324104566289924,0.000196675264352754,6.45242726389819e-05,-7.02263194572267e-05,-0.000205388404411664,-0.000338739823905328,-0.000468064068621384,-0.000591183679762215,-0.000705997522227032,-0.000810516923949013,-0.000902898979144424,-0.000981478364283469,-0.00104479717999074,-0.00109163088084250,-0.00112101269837072,-0.00113224987378142,-0.00112494078509780,-0.00109898400540037,-0.00105458322377551,-0.000992248214715288,-0.000912790655350924,-0.000817312190094874,-0.000707192664299225,-0.000584068586053318,-0.000449810976291049,-0.000306496458121528,-0.000156375928936700,-1.83927160480572e-06,0.000154620410304962,0.000310448508922747,0.000463069864550597,0.000609929496168213,0.000748536015441579,0.000876503080325177,0.000991589597602770,0.00109173807955301,0.00117511136602496,0.00124012569619907,0.00128547867293116,0.00131017632505477,0.00131354995481859,0.00129527475482555,0.00125537719959944,0.00119424043644752,0.00111260101210250,0.00101154266848190,0.000892482215872872,0.000757151520476956,0.000607570674090450,0.000446022069092219,0.000275013366010567,9.72406182180519e-05,-8.44537135488293e-05,-0.000267125432349431,-0.000447776449636035,-0.000623401378361117,-0.000791039070185408,-0.000947819792623646,-0.00109101513141935,-0.00121808323205026,-0.00132671436642415,-0.00141486953698114,-0.00148082127744312,-0.00152318248648333,-0.00154093588141140,-0.00153345428780976,-0.00150051830046164,-0.00144232297261349,-0.00135948166800276,-0.00125302168041858,-0.00112437216021684,-0.000975347293520130,-0.000808121168809696,-0.000625197321782440,-0.000429372776211124,-0.000223695469382705,-1.14179896641233e-05,0.000204052514077331,0.000419208261910524,0.000630495839478276,0.000834375754170128,0.00102737928287700,0.00120616586938604,0.00136758087471253,0.00150870943496767,0.00162692685375153,0.00171994735910834,0.00178586476558991,0.00182319054945124,0.00183088337770479,0.00180837384807226,0.00175557897141084,0.00167291346107668,0.00156128721379761,0.00142210083058266,0.00125722802785263,0.00106899346195185,0.000860139929015728,0.000633792337825671,0.000393410800444752,0.000142739280183784,-0.000114250539420890,-0.000373420440788405,-0.000630531562137561,-0.000881310791059904,-0.00112152152287652,-0.00134703173364624,-0.00155388428378092,-0.00173836362683720,-0.00189706061785530,-0.00202693274592887,-0.00212536028217606,-0.00219019488695641,-0.00221980444159939,-0.00221310514549828,-0.00216959041392536,-0.00208934844068358,-0.00197307069365014,-0.00182205022179931,-0.00163817192338033,-0.00142389086798522,-0.00118220296695517,-0.000916605503961005,-0.000631048518432133,-0.000329879021555524,-1.77775309540686e-05,0.000300312921265223,0.000619261140938976,0.000933828649827672,0.00123875198592560,0.00152882885885463,0.00179900110959019,0.00204444250999911,0.00226063885621870,0.00244346788215522,0.00258927252924391,0.00269493029590576,0.00275791231370502,0.00277633716051460,0.00274901166619134,0.00267546599469798,0.00255597333193323,0.00239156138500514,0.00218401008091388,0.00193583814523832,0.00165027732318610,0.00133123565169080,0.000983246384448231,0.000611410586737097,0.000221325184810418,-0.000180995890530672,-0.000589210224056401,-0.000996739690000448,-0.00139687301065444,-0.00178286822787008,-0.00214806181366420,-0.00248597565088297,-0.00279042505157156,-0.00305562356263471,-0.00327628486300240,-0.00344771779429896,-0.00356591446189854,-0.00362763087234735,-0.00363045483667365,-0.00357286458931795,-0.00345427440907880,-0.00327506591728960,-0.00303660506604835,-0.00274124595415995,-0.00239231692823026,-0.00199409358681478,-0.00155175418427772,-0.00107132262799520,-0.000559595541147094,-2.40556464617201e-05,0.000527226910504309,0.00108570414145287,0.00164247160363796,0.00218839498166672,0.00271424759274516,0.00321084875386722,0.00366920744591271,0.00408066497134396,0.00443703951479343,0.00473076220556386,0.00495501304006747,0.00510384517592065,0.00517230255788852,0.00515652340461247,0.00505383309045608,0.00486281976179471,0.00458339638454934,0.00421684333722663,0.00376583303261063,0.00323443552442523,0.00262810560225920,0.00195364742951991,0.00121916267878071,0.000433976904802159,-0.000391452089786903,-0.00124564387047394,-0.00211622075301407,-0.00299005033171056,-0.00385339941382973,-0.00469210250596706,-0.00549173602947808,-0.00623780439804942,-0.00691592820755239,-0.00751203607753926,-0.00801255640789340,-0.00840460733734303,-0.00867618029714317,-0.00881631804791550,-0.00881528027772628,-0.00866469819024795,-0.00835771469428941,-0.00788910748245482,-0.00725539219257209,-0.00645490818685877,-0.00548788003052527,-0.00435645824595169,-0.00306473445694684,-0.00161873537487000,-2.63887955865096e-05,0.00170253016149468,0.00355648106981076,0.00552225952960706,0.00758512237400555,0.00972893167273347,0.0119363209592466,0.0141888738050880,0.0164673215875612,0.0187517504800635,0.0210218203958728,0.0232569900463314,0.0254367474970380,0.0275408416634129,0.0295495131166864,0.0314437189354986,0.0332053541943589,0.0348174595931014,0.0362644193505947,0.0375321428541053,0.0386082300755930,0.0394821159443110,0.0401451957891558,0.0405909250712904,0.0408148976508848,0.0408148976508848,0.0405909250712904,0.0401451957891558,0.0394821159443110,0.0386082300755930,0.0375321428541053,0.0362644193505947,0.0348174595931014,0.0332053541943589,0.0314437189354986,0.0295495131166864,0.0275408416634129,0.0254367474970380,0.0232569900463314,0.0210218203958728,0.0187517504800635,0.0164673215875612,0.0141888738050880,0.0119363209592466,0.00972893167273347,0.00758512237400555,0.00552225952960706,0.00355648106981076,0.00170253016149468,-2.63887955865096e-05,-0.00161873537487000,-0.00306473445694684,-0.00435645824595169,-0.00548788003052527,-0.00645490818685877,-0.00725539219257209,-0.00788910748245482,-0.00835771469428941,-0.00866469819024795,-0.00881528027772628,-0.00881631804791550,-0.00867618029714317,-0.00840460733734303,-0.00801255640789340,-0.00751203607753926,-0.00691592820755239,-0.00623780439804942,-0.00549173602947808,-0.00469210250596706,-0.00385339941382973,-0.00299005033171056,-0.00211622075301407,-0.00124564387047394,-0.000391452089786903,0.000433976904802159,0.00121916267878071,0.00195364742951991,0.00262810560225920,0.00323443552442523,0.00376583303261063,0.00421684333722663,0.00458339638454934,0.00486281976179471,0.00505383309045608,0.00515652340461247,0.00517230255788852,0.00510384517592065,0.00495501304006747,0.00473076220556386,0.00443703951479343,0.00408066497134396,0.00366920744591271,0.00321084875386722,0.00271424759274516,0.00218839498166672,0.00164247160363796,0.00108570414145287,0.000527226910504309,-2.40556464617201e-05,-0.000559595541147094,-0.00107132262799520,-0.00155175418427772,-0.00199409358681478,-0.00239231692823026,-0.00274124595415995,-0.00303660506604835,-0.00327506591728960,-0.00345427440907880,-0.00357286458931795,-0.00363045483667365,-0.00362763087234735,-0.00356591446189854,-0.00344771779429896,-0.00327628486300240,-0.00305562356263471,-0.00279042505157156,-0.00248597565088297,-0.00214806181366420,-0.00178286822787008,-0.00139687301065444,-0.000996739690000448,-0.000589210224056401,-0.000180995890530672,0.000221325184810418,0.000611410586737097,0.000983246384448231,0.00133123565169080,0.00165027732318610,0.00193583814523832,0.00218401008091388,0.00239156138500514,0.00255597333193323,0.00267546599469798,0.00274901166619134,0.00277633716051460,0.00275791231370502,0.00269493029590576,0.00258927252924391,0.00244346788215522,0.00226063885621870,0.00204444250999911,0.00179900110959019,0.00152882885885463,0.00123875198592560,0.000933828649827672,0.000619261140938976,0.000300312921265223,-1.77775309540686e-05,-0.000329879021555524,-0.000631048518432133,-0.000916605503961005,-0.00118220296695517,-0.00142389086798522,-0.00163817192338033,-0.00182205022179931,-0.00197307069365014,-0.00208934844068358,-0.00216959041392536,-0.00221310514549828,-0.00221980444159939,-0.00219019488695641,-0.00212536028217606,-0.00202693274592887,-0.00189706061785530,-0.00173836362683720,-0.00155388428378092,-0.00134703173364624,-0.00112152152287652,-0.000881310791059904,-0.000630531562137561,-0.000373420440788405,-0.000114250539420890,0.000142739280183784,0.000393410800444752,0.000633792337825671,0.000860139929015728,0.00106899346195185,0.00125722802785263,0.00142210083058266,0.00156128721379761,0.00167291346107668,0.00175557897141084,0.00180837384807226,0.00183088337770479,0.00182319054945124,0.00178586476558991,0.00171994735910834,0.00162692685375153,0.00150870943496767,0.00136758087471253,0.00120616586938604,0.00102737928287700,0.000834375754170128,0.000630495839478276,0.000419208261910524,0.000204052514077331,-1.14179896641233e-05,-0.000223695469382705,-0.000429372776211124,-0.000625197321782440,-0.000808121168809696,-0.000975347293520130,-0.00112437216021684,-0.00125302168041858,-0.00135948166800276,-0.00144232297261349,-0.00150051830046164,-0.00153345428780976,-0.00154093588141140,-0.00152318248648333,-0.00148082127744312,-0.00141486953698114,-0.00132671436642415,-0.00121808323205026,-0.00109101513141935,-0.000947819792623646,-0.000791039070185408,-0.000623401378361117,-0.000447776449636035,-0.000267125432349431,-8.44537135488293e-05,9.72406182180519e-05,0.000275013366010567,0.000446022069092219,0.000607570674090450,0.000757151520476956,0.000892482215872872,0.00101154266848190,0.00111260101210250,0.00119424043644752,0.00125537719959944,0.00129527475482555,0.00131354995481859,0.00131017632505477,0.00128547867293116,0.00124012569619907,0.00117511136602496,0.00109173807955301,0.000991589597602770,0.000876503080325177,0.000748536015441579,0.000609929496168213,0.000463069864550597,0.000310448508922747,0.000154620410304962,-1.83927160480572e-06,-0.000156375928936700,-0.000306496458121528,-0.000449810976291049,-0.000584068586053318,-0.000707192664299225,-0.000817312190094874,-0.000912790655350924,-0.000992248214715288,-0.00105458322377551,-0.00109898400540037,-0.00112494078509780,-0.00113224987378142,-0.00112101269837072,-0.00109163088084250,-0.00104479717999074,-0.000981478364283469,-0.000902898979144424,-0.000810516923949013,-0.000705997522227032,-0.000591183679762215,-0.000468064068621384,-0.000338739823905328,-0.000205388404411664,-7.02263194572267e-05,6.45242726389819e-05,0.000196675264352754,0.000324104566289924,0.000444792895645779,0.000556852312673343,0.000658558286059258,0.000748372500296638,0.000824968980398018,0.000887251773533178,0.000934369781638677,0.000965727676574643,0.000980994188353147,0.000980102542871292,0.000963249201928251,0.000930888812917662,0.000883722586346968,0.000822684532977004,0.000748923812117662,0.000663782584260908,0.000568774103622529,0.000465555063218378,0.000355895887374739,0.000241653148591869,0.000124736733272724,7.07848917941029e-06,-0.000109398538226471,-0.000222812388452414,-0.000331351618758526,-0.000433304186184608,-0.000527084279118563,-0.000611254817961073,-0.000684553562157931,-0.000745906399160176,-0.000794446827345814,-0.000829524432645101,-0.000850716961112408,-0.000857830219721054,-0.000850902659603595,-0.000830199247672145,-0.000796206625256528,-0.000749621821375045,-0.000691339754590524,-0.000622433723658288,-0.000544139677818541,-0.000457832675348493,-0.000365002635441001,-0.000267228761895830,-0.000166154999731449,-6.34592481415192e-05,3.91704658178099e-05,0.000140066661502563,0.000237607145899030,0.000330241556358892,0.000416516313096390,0.000495097837792508,0.000564789139052792,0.000624552755946382,0.000673521893884384,0.000711015744165886,0.000736546227770061,0.000749824827120827,0.000750765940471367,0.000739483609729422,0.000716290775598435,0.000681690067285356,0.000636363812383791,0.000581160810857630,0.000517082361126813,0.000445263436354313,0.000366951518438847,0.000283487733525262,0.000196281941637141,0.000106790491610650,1.64914732557254e-05,-7.31389752584774e-05,-0.000160652499197408,-0.000244647791762693,-0.000323796403229365,-0.000396863093405334,-0.000462723166378992,-0.000520380095045351,-0.000568982037161993,-0.000607831487855772,-0.000636398144283884,-0.000654322623905585,-0.000661421659859617,-0.000657690996181785,-0.000643300612057584,-0.000618591774039035,-0.000584071218684803,-0.000540398042291797,-0.000488374904730534,-0.000428928377796532,-0.000363099900534966,-0.000292021249014567,-0.000216899617628328,-0.000138994368860783,-5.95985951963207e-05,1.99851971848758e-05,9.84633346944140e-05,0.000174572395793624,0.000247101135080755,0.000314908666946289,0.000376940730527705,0.000432247478952771,0.000479998165518619,0.000519491633260520,0.000550168646306322,0.000571617978441591,0.000583580499205085,0.000585954971277827,0.000578796844499311,0.000562312936116689,0.000536861209206057,0.000502940614454311,0.000461182329170659,0.000412339002055470,0.000357268916070740,0.000296924222671615,0.000232334473193572,0.000164584552407943,9.48037818840560e-05,2.41398750544400e-05,-4.62518403256546e-05,-0.000115236134011642,-0.000181707184597773,-0.000244612441900505,-0.000302965778407537,-0.000355866462104797,-0.000402507436051924,-0.000442191622764166,-0.000474340515033717,-0.000498503145667948,-0.000514360646519420,-0.000521733999059619,-0.000520580514996786,-0.000510995500741959,-0.000493210210850345,-0.000467587422705800,-0.000434610347563412,-0.000394879495464152,-0.000349096499575980,-0.000298055235060350,-0.000242628668821802,-0.000183751696215942,-0.000122404362517083,-5.96021674344357e-05,3.62869610472787e-06,6.62612361291507e-05,0.000127289069560860,0.000185740784118701,0.000240691459938112,0.000291284693569558,0.000336738965340443,0.000376364188681789,0.000409567205052743,0.000435865324112567,0.000454891355690830,0.000466396735324246,0.000470256193958826,0.000466468920583249,0.000455157563038635,0.000436562203030405,0.000411040615525717,0.000379058794945381,0.000341181660185946,0.000298063298540243,0.000250439255459646,0.000199109077318620,0.000144926733375070,8.87871790004457e-05,3.16076676763005e-05,-2.56863738189903e-05,-8.21711356844803e-05,-0.000136945536225613,-0.000189140941250390,-0.000237935163580332,-0.000282570706896469,-0.000322358479850360,-0.000356691139961457,-0.000385056437165981,-0.000407036320260477,-0.000422324253930742,-0.000430714449251630,-0.000432118431764753,-0.000426556578525578,-0.000414163075031353,-0.000395176541125184,-0.000369940199115785,-0.000338895631005722,-0.000302573512350337,-0.000261583319809913,-0.000216605447226913,-0.000168381669842934,-0.000117698384940092,-6.53757219002342e-05,-1.22567824713025e-05,4.08071879384541e-05,9.29740861539524e-05,0.000143417522404322,0.000191342287359710,0.000236000302507780,0.000276698241071409,0.000312805631485511,0.000343772740961769,0.000369128831967067,0.000388492953784088,0.000401585034665167,0.000408221368910749,0.000408320646671165,0.000401907978976980,0.000389099899664676,0.000370124886760675,0.000345296447864744,0.000315028019306567,0.000279806420137797,0.000240199400121135,0.000196837925734623,0.000150413015883812,0.000101656093384248,5.13334666926273e-05,2.33044238200366e-07,-5.08443207718203e-05,-0.000101104966701900,-0.000149769408212541,-0.000196083949397595,-0.000239330058947103,-0.000278843926435940,-0.000314017556362906,-0.000344308646898737,-0.000369250910570586,-0.000388465629753992,-0.000401653978679479,-0.000408612322643847,-0.000409234633055663,-0.000403506415521024,-0.000391507253898978,-0.000373420058267764,-0.000349507361005986,-0.000320125765214131,-0.000285714339023659,-0.000246776447822431,-0.000203896740909895,-0.000157704524634687,-0.000108890442396419,-5.81758125771192e-05,-6.31261672583422e-06,4.59334289112132e-05,9.77898104171208e-05,0.000148485864543144,0.000197267999771596,0.000243411000569501,0.000286231032232203,0.000325087574582561,0.000359394593844842,0.000388630560960300,0.000412350764406740,0.000430184642433961,0.000441840344286906,0.000447114307872116,0.000445898443719604,0.000438169019539266,0.000423988535571798,0.000403516582632650,0.000377000467849776,0.000344759297967737,0.000307199408700968,0.000264805237174775,0.000218111821978267,0.000167726039497334,0.000114307683659333,5.85391127115271e-05,1.16500237913292e-06,-5.70774392494650e-05,-0.000115413121048971,-0.000173080290125052,-0.000229314563943658,-0.000283372376850920,-0.000334533963561470,-0.000382112798806305,-0.000425465389171147,-0.000463997148650752,-0.000497174641876562,-0.000524527610294248,-0.000545655914358072,-0.000560225433041453,-0.000567978444830152,-0.000568737117468277,-0.000562413452127669,-0.000548994973782714,-0.000528541965033473,-0.000501186865911540,-0.000467153031300441,-0.000426734623200886,-0.000380281044628104,-0.000328199841864864,-0.000270981700616504,-0.000209150548302986,-0.000143257253575443,-7.39182103943538e-05,-1.77387035401682e-06,7.25552863234774e-05,0.000148361331255145,0.000225011266096251,0.000301807309594783,0.000378106467101825,0.000453254420033164,0.000526636776745298,0.000597657556686056,0.000665764745959372,0.000730438786517532,0.000791212604532820,0.000847660094390404,0.000899414828534797,0.000946156291953633,0.000987627807278237,0.00102362111172862,0.00105399472317289,0.00107865737960569,0.00109758548297334,0.00111079990073462,0.00111837692208613,0.00112042535275341,0.00111711513033243,0.00110866973896642,0.00109537261573755,0.00107749862160338,0.00105532300675473,0.00102918182529550,0.000999514394982450,0.000966663459321278,0.000930943713027837,0.000892911702156326,0.000852814364232319,0.000811145637200738,0.000768249623924540,0.000724518358064113,0.000680317423289792,0.000635991131344177,0.000591875042383926,0.000548270863869313,0.000505468523745652,0.000463719034780796,0.000423258806136680,0.000384283083381531,0.000346971664009829,0.000311462882576880,0.000277880500320432,0.000246307895985598,0.000216815569173164,0.000189435777747655,0.000164190798870247,0.000141068119920134,0.000120050638969978,0.000101095234700965,8.41700731484088e-05,6.92480468414559e-05,5.63790099858873e-05,4.57605486090573e-05,3.79870921639086e-05,3.45228699961383e-05,3.88666338364547e-05,-3.06407413954917e-05];

filter_mul_i = conv(mul_sin,fil_coeff);
filter_mul_q = conv(mul_cos,fil_coeff);

fil_mix = filter_mul_i .* filter_mul_q;

figure(3);
subplot(3,1,1);
plot(filter_mul_i);
title('Filtered I output');
xlabel('time-->');
ylabel('amp-->');

subplot(3,1,2);
plot(filter_mul_q);
title('Filtered Q output');
xlabel('time-->');
ylabel('amp-->');

subplot(3,1,3);
plot(fil_mix);
title('Mixer output');
xlabel('time-->');
ylabel('amp-->');
m=mean(fil_mix);
